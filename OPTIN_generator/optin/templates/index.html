{% load static %}
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>OPT-IN</title>
    
    <link href="{% static 'css/stylesheet.css' %}" rel="stylesheet" type="text/css" />
    <style type="text/css">
        body {
            margin-left: 0px;
            margin-top: 0px;
            margin-right: 0px;
            margin-bottom: 0px;
            background-image: url(Main_slide_bg.jpg);
            background-repeat: repeat;
        }
        .style6 {font-size: 14px;
            color: #FFFFFF;
        }
        </style>
</head>
  <body>
    <div class="nav"><h1>Create and Download your OPT-in</h1></div>
    <form action="" method="post">
     {% csrf_token %} 
    {{form.as_p}}
    <button type="submit">save</button>
  </form>
    <!-- <form action="" class="" method="POST">
      {% csrf_token %}
      <div class="row opt_form" style="display: flex; padding: 15px;background-color: azure;">
        <div class="col-sm-2">
          <Label>NAME</Label>
          {{form.name}}
        </div>
        <div class="col-sm-2">
          <Label>NUMBER</Label>
          {{form.number}}
        </div>
        <div class="col-sm-2">
          <Label>EMAIL</Label>
          {{form.email}}
        </div>
        <div class="col-sm-2">
          <Label>DATE</Label>
          {{form.data}}
        </div>
        <div class="col-sm-2">
          <Label>HEADER</Label>
          {{form.header}}
        </div>
        <div class="col-sm-2">
          <Label>Footer</Label>
          {{form.footer}}
        </div>
       
        </div>
        <div class="col-sm-2">
          <button type="submit">save</button>
         </div>
    </form> -->
    <div class="container">
        <!-- Content here --
    {% for optin in optIn %}
    <!--download button--> 
    <table width="1000" border="0" align="center" class="opt-tbl" >
        <tr>
            <td align="center"> NAME: {{optin.name}}</td>
            <td align="center">NUMBER: {{optin.number}}</td>
            <td align="center">EMAIL: {{optin.email}}</td>
            <td align="center"><button onclick="captureTable('tbl{{optin.id}}','{{optin.number}}')">Download OPT-IN</button></td>
            <td><a href="delete/{{optin.id}}"><img src="{% static 'img/delete.png' %}" alt="" width="40" height="25"></a></td>
        </tr>
    </table>


<!--OPTIN table-->    
    
    <div class="optin">   
      <table class="opt-tbl" width="1000" border="0" align="center" cellpadding="0" cellspacing="0" style="background:#FFF" id="tbl{{optin.id}}">
        
        <tr>
          <td><img src="{{ optin.header.url }}" width="1000"/></td>
        </tr>
        <tr>
          <td>&nbsp;</td>
        </tr>
        <tr>
          <td><div class="main">
            <div class="leftpanel">
              <div class="hd1" style="background:#333;">Admin Menu </div>
              <div class="menu">
                <table width="200" border="0" cellspacing="1" cellpadding="5">
                  <tr>
                    <td width="12" bgcolor="#FFFFFF"><img src="{% static 'img/arrow.jpeg' %}" width="10" height="12" /></td>
                    <td width="189" bgcolor="#FFFFFF"><strong>List Registred Person</strong></td>
                  </tr>
                  <tr>
                    <td bgcolor="#FFFFFF"><img src="{% static 'img/arrow.jpeg' %}" width="10" height="12" /></td>
                    <td bgcolor="#FFFFFF">Change Password</td>
                  </tr>
                  <tr>
                    <td bgcolor="#FFFFFF"><img src="{% static 'img/arrow.jpeg' %}" width="10" height="12" /></td>
                    <td bgcolor="#FFFFFF">Logout</td>
                  </tr>
                </table>
              </div>
            </div>
            <div class="rightpanel">
              <div class="hd1" style="width:740px; background:#333">
                <table width="643" border="0" cellspacing="0" cellpadding="0">
                  <tr>
                    <td width="337">List Registred Person</td>
                    <td width="59"><span class="style6">Search</span></td>
                    <td width="247"><form id="form1" name="form1" method="post" action="">
                      <label>
                        <input type="text" name="textfield" placeholder="{{optin.number}}"/>
                      </label>
                      <label>
                        <input type="submit" name="Submit" value="GO" />
                      </label>
                    </form></td>
                  </tr>
                </table>
              </div>
              <div style="float:left">
                <table width="750" border="1" cellpadding="5" cellspacing="0">
                  
                  <tr height="20">
                    <td width="146" height="20" bgcolor="#D9D9D9">Name</td>
                    <td width="145" bgcolor="#D9D9D9">Mobile</td>
                    <td width="251" bgcolor="#D9D9D9">Email</td>
                    <td width="83" bgcolor="#D9D9D9">Date</td>
                    <td width="63" bgcolor="#D9D9D9">&nbsp;</td>
                  </tr>
                  <tr height="20">
                    <td height="20">{{optin.name}}</td>
                    <td align="right"><span style="background:#FF0">{{optin.number}}</span></td>
                    <td>{{optin.email}}</td>
                    <td>{{optin.data}}</td>
                    <td><img src="{% static 'img/croos.jpeg' %}" width="20" height="20" /></td>
                  </tr>
                </table>
              </div>
            </div>
          </div></td>
        </tr>
        <tr>
          <td height="100">&nbsp;</td>
        </tr>
        <tr>
          <td><img src="{{ optin.footer.url }}" width="1000"/></td>
        </tr>
      </table>
      
    </div> 
      {% endfor %}
    
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.5.0-beta4/html2canvas.min.js"></script>
 <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
 <script>
    function captureTable(tableid,imgname) {
        const table = document.getElementById(tableid);
        html2canvas(table).then(function(canvas) {
            const imgData = canvas.toDataURL('image/png');

            // // You can display the image, save it, or send it to the server
            // const img = new Image();
            // img.src = imgData;
            // document.body.appendChild(img);
            // Create a link to download the image
            const a = document.createElement('a');
            a.href = imgData;
            a.download = imgname+'.png'; // Specify the desired file name and extension

            // Trigger a click event on the link to download the image
            a.click();

            // If you want to save it as a PDF, you can send the image data to the server and convert it to PDF using a Python library.
        });
    }
</script>
</body>
</html>